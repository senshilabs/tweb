class f{constructor(e,t="GET"){this.apiEndpoint=`https://6iuhvr5pl9.execute-api.us-west-2.amazonaws.com/default/api${e}`,this.method=t}getHMAC(){return window.Telegram.WebApp.initData}fetchData(e){const t=this.getHMAC(),i={method:this.method,headers:{"Content-Type":"application/json",Authorization:`${t}`}};return this.method==="POST"&&e&&(i.body=JSON.stringify(e)),fetch(this.apiEndpoint,i).then(a=>(console.log({response:a}),a.ok?a.json():Promise.reject(a))).catch(a=>{throw new Error("Failed to fetch data")})}}function g(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function O(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function C(n,e,t){return e&&O(n.prototype,e),n}function S(n){return+n.replace(/px/,"")}function j(n){var e=window.devicePixelRatio,t=getComputedStyle(n),i=S(t.getPropertyValue("width")),a=S(t.getPropertyValue("height"));n.setAttribute("width",(i*e).toString()),n.setAttribute("height",(a*e).toString())}function m(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=Math.random()*(e-n)+n;return Math.floor(i*Math.pow(10,t))/Math.pow(10,t)}function E(n){return n[m(0,n.length)]}var L=.00125,P=5e-4,W=9e-4,k=1e-5,F=6,B=80,M=.9,z=1.7,U=.2,X=.6,$=.03,H=.07,b=15,_=82,q=150,G=100,J=250,V=40,Y=["#fcf403","#62fc03","#f4fc03","#03e7fc","#03fca5","#a503fc","#fc03ad","#fc03c2"];function x(n){var e=1920;return Math.log(n)/Math.log(e)}var T=function(){function n(e){g(this,n);var t=e.initialPosition,i=e.direction,a=e.confettiRadius,o=e.confettiColors,s=e.emojis,l=e.emojiSize,r=e.canvasWidth,c=m(M,z,3),d=c*x(r);this.confettiSpeed={x:d,y:d},this.finalConfettiSpeedX=m(U,X,3),this.rotationSpeed=s.length?.01:m($,H,3)*x(r),this.dragForceCoefficient=m(P,W,6),this.radius={x:a,y:a},this.initialRadius=a,this.rotationAngle=i==="left"?m(0,.2,3):m(-.2,0,3),this.emojiSize=l,this.emojiRotationAngle=m(0,2*Math.PI),this.radiusYUpdateDirection="down";var h=i==="left"?m(_,b)*Math.PI/180:m(-b,-_)*Math.PI/180;this.absCos=Math.abs(Math.cos(h)),this.absSin=Math.abs(Math.sin(h));var p=m(-q,0),u={x:t.x+(i==="left"?-p:p)*this.absCos,y:t.y-p*this.absSin};this.currentPosition=Object.assign({},u),this.initialPosition=Object.assign({},u),this.color=s.length?null:E(o),this.emoji=s.length?E(s):null,this.createdAt=new Date().getTime(),this.direction=i}return C(n,[{key:"draw",value:function(t){var i=this.currentPosition,a=this.radius,o=this.color,s=this.emoji,l=this.rotationAngle,r=this.emojiRotationAngle,c=this.emojiSize,d=window.devicePixelRatio;o?(t.fillStyle=o,t.beginPath(),t.ellipse(i.x*d,i.y*d,a.x*d,a.y*d,l,0,2*Math.PI),t.fill()):s&&(t.font="".concat(c,"px serif"),t.save(),t.translate(d*i.x,d*i.y),t.rotate(r),t.textAlign="center",t.fillText(s,0,0),t.restore())}},{key:"updatePosition",value:function(t,i){var a=this.confettiSpeed,o=this.dragForceCoefficient,s=this.finalConfettiSpeedX,l=this.radiusYUpdateDirection,r=this.rotationSpeed,c=this.createdAt,d=this.direction,h=i-c;if(a.x>s&&(this.confettiSpeed.x-=o*t),this.currentPosition.x+=a.x*(d==="left"?-this.absCos:this.absCos)*t,this.currentPosition.y=this.initialPosition.y-a.y*this.absSin*h+L*Math.pow(h,2)/2,this.rotationSpeed-=this.emoji?1e-4:k*t,this.rotationSpeed<0&&(this.rotationSpeed=0),this.emoji){this.emojiRotationAngle+=this.rotationSpeed*t%(2*Math.PI);return}l==="down"?(this.radius.y-=t*r,this.radius.y<=0&&(this.radius.y=0,this.radiusYUpdateDirection="up")):(this.radius.y+=t*r,this.radius.y>=this.initialRadius&&(this.radius.y=this.initialRadius,this.radiusYUpdateDirection="down"))}},{key:"getIsVisibleOnCanvas",value:function(t){return this.currentPosition.y<t+G}}]),n}();function Z(){var n=document.createElement("canvas");return n.style.position="fixed",n.style.width="100%",n.style.height="100%",n.style.top="0",n.style.left="0",n.style.zIndex="1000",n.style.pointerEvents="none",document.body.appendChild(n),n}function K(n){var e=n.confettiRadius,t=e===void 0?F:e,i=n.confettiNumber,a=i===void 0?n.confettiesNumber||(n.emojis?V:J):i,o=n.confettiColors,s=o===void 0?Y:o,l=n.emojis,r=l===void 0?n.emojies||[]:l,c=n.emojiSize,d=c===void 0?B:c;return n.emojies&&console.error("emojies argument is deprecated, please use emojis instead"),n.confettiesNumber&&console.error("confettiesNumber argument is deprecated, please use confettiNumber instead"),{confettiRadius:t,confettiNumber:a,confettiColors:s,emojis:r,emojiSize:d}}var Q=function(){function n(e){var t=this;g(this,n),this.canvasContext=e,this.shapes=[],this.promise=new Promise(function(i){return t.resolvePromise=i})}return C(n,[{key:"getBatchCompletePromise",value:function(){return this.promise}},{key:"addShapes",value:function(){var t;(t=this.shapes).push.apply(t,arguments)}},{key:"complete",value:function(){var t;return this.shapes.length?!1:((t=this.resolvePromise)===null||t===void 0||t.call(this),!0)}},{key:"processShapes",value:function(t,i,a){var o=this,s=t.timeDelta,l=t.currentTime;this.shapes=this.shapes.filter(function(r){return r.updatePosition(s,l),r.draw(o.canvasContext),a?r.getIsVisibleOnCanvas(i):!0})}}]),n}(),tt=function(){function n(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};g(this,n),this.activeConfettiBatches=[],this.canvas=e.canvas||Z(),this.canvasContext=this.canvas.getContext("2d"),this.requestAnimationFrameRequested=!1,this.lastUpdated=new Date().getTime(),this.iterationIndex=0,this.loop=this.loop.bind(this),requestAnimationFrame(this.loop)}return C(n,[{key:"loop",value:function(){this.requestAnimationFrameRequested=!1,j(this.canvas);var t=new Date().getTime(),i=t-this.lastUpdated,a=this.canvas.offsetHeight,o=this.iterationIndex%10===0;this.activeConfettiBatches=this.activeConfettiBatches.filter(function(s){return s.processShapes({timeDelta:i,currentTime:t},a,o),o?!s.complete():!0}),this.iterationIndex++,this.queueAnimationFrameIfNeeded(t)}},{key:"queueAnimationFrameIfNeeded",value:function(t){this.requestAnimationFrameRequested||this.activeConfettiBatches.length<1||(this.requestAnimationFrameRequested=!0,this.lastUpdated=t||new Date().getTime(),requestAnimationFrame(this.loop))}},{key:"addConfetti",value:function(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=K(t),a=i.confettiRadius,o=i.confettiNumber,s=i.confettiColors,l=i.emojis,r=i.emojiSize,c=this.canvas.getBoundingClientRect(),d=c.width,h=c.height,p=h*5/7,u={x:0,y:p},D={x:d,y:p},v=new Q(this.canvasContext),w=0;w<o/2;w++){var N=new T({initialPosition:u,direction:"right",confettiRadius:a,confettiColors:s,confettiNumber:o,emojis:l,emojiSize:r,canvasWidth:d}),R=new T({initialPosition:D,direction:"left",confettiRadius:a,confettiColors:s,confettiNumber:o,emojis:l,emojiSize:r,canvasWidth:d});v.addShapes(N,R)}return this.activeConfettiBatches.push(v),this.queueAnimationFrameIfNeeded(),v.getBatchCompletePromise()}},{key:"clearCanvas",value:function(){this.activeConfettiBatches=[]}},{key:"destroyCanvas",value:function(){this.canvas.remove()}}]),n}();class et{constructor(){this.jsConfetti=new tt}addConfetti(){this.jsConfetti.addConfetti({emojis:["💵","🎁","💎","🤑"]})}}const it=new et,I=new f("/me","GET"),nt=new f("/earlybird","POST"),at=new f("/server-info","GET"),y=new f("/achievements","POST");class A{init(){this.dashboardLayer=document.getElementById("dashboard-layer"),this.updateDashboard()}clearDashboard(){this.dashboardLayer.innerHTML=""}async updateDashboard(){try{this.clearDashboard();const e=await I.fetchData(),t=await at.fetchData(),i={follow_on_x:{key:"follow_on_twitter",isClaimed:e.Achievements.follow_on_twitter||!1,amount:t.achievements.follow_on_twitter},subscribe_on_telegram:{key:"follow_on_telegram",isClaimed:e.Achievements.follow_on_telegram||!1,amount:t.achievements.follow_on_telegram},share_on_x:{key:"share_on_twitter",isClaimed:e.Achievements.share_on_twitter||!1,amount:t.achievements.share_on_twitter}};this.createBalance(e.Balance.Total),this.createEvent(e.EarlyBirdClaim,t.earlybird_points),this.createTask(i),this.createInvitation()}catch(e){console.error("Error updating dashboard:",e)}}async claimEarlyBird(){try{await nt.fetchData(),this.updateBalance(),this.updateClaimButton(!1),it.addConfetti()}catch(e){console.error("Error claiming airdrop:",e)}}async updateBalance(e=document.getElementById("tm-balance")){try{const t=await I.fetchData();e.textContent=t.Balance.Total.toString()}catch(t){console.error("Error updating balance:",t)}}updateClaimButton(e,t=0,i=document.getElementById("tm-claim-btn")){e?(i.textContent=`Claim ${t} mTON`,i.classList.remove("tm-button-inactive"),i.classList.add("tm-button-active"),i.addEventListener("click",()=>{this.claimEarlyBird()})):(i.textContent="Claimed",i.classList.remove("tm-button-active"),i.classList.add("tm-button-inactive"))}createBalance(e){this.dashboardElement=document.createElement("div"),this.setStyle(this.dashboardElement,{display:"flex",flexDirection:"column",alignItems:"center",padding:"24px 16px"});const t=this.createElementWithStyle("div",{width:"100%"}),i=this.createElementWithStyle("p",{fontSize:"20px",fontWeight:"bold"},"Hi! "+(window.Telegram.WebApp.initDataUnsafe.user.first_name||window.Telegram.WebApp.initDataUnsafe.user.user_name||"Undefined"));i.classList.add("tm-title"),t.appendChild(i),this.dashboardElement.appendChild(t);const a=this.createElementWithStyle("div",{width:"100%",background:"white",borderRadius:"8px",height:"130px",border:"1px solid #F4F4F4",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:"16px"}),o=this.createElementWithStyle("div",{width:"100%"}),s=this.createElementWithStyle("p",{fontSize:"18px",fontWeight:"bold"},"Rewards");s.classList.add("tm-title"),o.appendChild(s),a.appendChild(o);const l=this.createElementWithStyle("div",{width:"100%",background:"#ECF2F9",height:"61px",display:"flex",alignItems:"center",justifyContent:"space-between",borderRadius:"4px",padding:"20px 12px",color:"#417FC6",fontSize:"16px",fontWeight:"bold"}),r=this.createElementWithStyle("div",{display:"flex",alignItems:"center"}),c=this.createElementWithStyle("img",{width:"24px",height:"24px",marginRight:"6px"});c.src="/assets/img/mTON.png";const d=document.createElement("p");d.textContent="Balance",r.appendChild(c),r.appendChild(d),l.appendChild(r);const h=this.createElementWithStyle("div",{display:"flex",alignItems:"center"}),p=this.createElementWithStyle("p",{marginRight:"4px"},e.toString());p.id="tm-balance";const u=document.createElement("p");u.textContent="mTON",h.appendChild(p),h.appendChild(u),l.appendChild(h),a.appendChild(l),this.dashboardElement.appendChild(a),this.dashboardLayer.appendChild(this.dashboardElement)}createEvent(e=!1,t=0){const i=this.createElementWithStyle("div",{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",padding:"24px 16px"}),a=this.createElementWithStyle("p",{width:"100%",fontSize:"18px",fontWeight:"bold"},"Early Bird Event🐦");a.classList.add("tm-title");const o=this.createElementWithStyle("div",{width:"100%"});o.id="tm-claim-btn",e?(o.textContent="Claimed",o.classList.add("tm-button-inactive")):(o.textContent=`Claim ${t} mTON`,o.classList.add("tm-button-active"),o.addEventListener("click",()=>{this.claimEarlyBird()})),i.appendChild(a),i.appendChild(o),this.dashboardLayer.appendChild(i)}createTaskButton(e,t,i,a,o){const s=this.createElementWithStyle("div",{display:"flex",flexDirection:"row",alignItems:"center",marginBottom:"7px"});s.classList.add(a?"tm-button-inactive":"tm-button-active");const l=this.createElementWithStyle("img",{width:"24px",height:"24px",marginRight:"12px"});l.src=e==="telegram"?"/assets/img/icon-telegram.png":"/assets/img/icon-x.png";const r=this.createElementWithStyle("div",{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center"}),c=this.createElementWithStyle("p",{fontSize:"16px",margin:"0",fontWeight:"bold"},t),d=this.createElementWithStyle("p",{fontSize:"10px",margin:"0",lineHeight:"1"},`+ ${i} mTON`);return a||s.addEventListener("click",()=>{o()}),r.appendChild(c),r.appendChild(d),s.appendChild(l),s.appendChild(r),s}createSubscribeTelegram(e){return this.createTaskButton("telegram","Subscribe Telegram",e.amount,e.isClaimed,async()=>{const t={achievement:e.key};try{await y.fetchData(t)}catch(i){console.error(i)}})}createFollowX(e){return this.createTaskButton("x","Follow on X",e.amount,e.isClaimed,async()=>{const t={achievement:e.key};try{window.open("https://twitter.com/TelegramMini"),await y.fetchData(t),this.updateDashboard()}catch(i){console.error(i)}})}createShareX(e){return this.createTaskButton("x","Share Referral link on X",e.amount,e.isClaimed,async()=>{const t={achievement:e.key};try{await y.fetchData(t);var i=`"Telegram Mini" App is just Telegram Mini App

`,a=`
By this link, you can receive 200 mTON

`,o=`t.me/tele_gram_mini_bot/app?startapp=ref_${window.Telegram.WebApp.initDataUnsafe.user.id}`,s=" $TON $mTON",l=" @TelegramMini",r="https://twitter.com/intent/tweet?text="+encodeURIComponent(i)+"&url="+encodeURIComponent(o)+encodeURIComponent(a)+encodeURIComponent(s)+encodeURIComponent(l);window.open(r,"_blank"),this.updateDashboard()}catch(c){console.error(c)}})}createTask(e){const t=document.createElement("div");t.style.width="100%",t.style.display="flex",t.style.flexDirection="column",t.style.alignItems="flex-start",t.style.paddingTop="24px",t.style.paddingBottom="24px",t.style.paddingLeft="16px",t.style.paddingRight="16px";const i=document.createElement("p");i.textContent="Task📝",i.style.width="100%",i.style.fontSize="18px",i.style.fontWeight="bold",i.classList.add("tm-title");const a=this.createFollowX(e.follow_on_x),o=this.createShareX(e.share_on_x);t.appendChild(i),t.appendChild(a),t.appendChild(o),this.dashboardLayer.appendChild(t)}createInvitation(){const e=this.createElementWithStyle("div",{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",padding:"24px 16px"}),t=this.createElementWithStyle("p",{width:"fit-content",fontSize:"18px",fontWeight:"bold",marginBottom:"0px"},"Invite Frens🎉");t.classList.add("tm-title");const i=this.createElementWithStyle("p",{width:"fit-content",fontSize:"12px",color:"#888888",margin:"0",marginLeft:"5px",marginBottom:"12px"},"Referral gives your frens 200 mTON and earns you 1 mTON every time a fren claims."),a=this.createElementWithStyle("div",{display:"flex",flexDirection:"column",width:"100%",alignItems:"baseline"});a.appendChild(t),a.appendChild(i);const o=this.createElementWithStyle("div",{width:"49.5%"},"Copy link");o.classList.add("tm-button-active"),o.addEventListener("click",()=>{const r=`t.me/tele_gram_mini_bot/app?startapp=ref_${window.Telegram.WebApp.initDataUnsafe.user.id}`;navigator.clipboard.writeText(r).then(()=>{console.log("Link copied to clipboard:",r)}).catch(c=>{console.error("Error copying link to clipboard:",c)})});const s=this.createElementWithStyle("div",{width:"49.5%"},"Send");s.classList.add("tm-button-active"),s.addEventListener("click",()=>{const r=`https://t.me/share/url?url=t.me/tele_gram_mini_bot/app?startapp=ref_${window.Telegram.WebApp.initDataUnsafe.user.id}`+encodeURIComponent(" Join TelegramMini through this link and receive 200 mTON! Let's earn together! 🤑");window.open(r)});const l=this.createElementWithStyle("div",{display:"flex",flexDirection:"row",justifyContent:"space-between",width:"100%"});l.appendChild(o),l.appendChild(s),e.appendChild(a),e.appendChild(l),this.dashboardLayer.appendChild(e)}setStyle(e,t){for(const i in t)e.style[i]=t[i]}createElementWithStyle(e,t,i){const a=document.createElement(e);return this.setStyle(a,t),i&&(a.textContent=i),a}}const ot=new A,st=Object.freeze(Object.defineProperty({__proto__:null,AirdropDashBoard:A,default:ot},Symbol.toStringTag,{value:"Module"}));export{f as H,st as a,it as c,ot as d};
//# sourceMappingURL=dashboard-CkKUY26q.js.map
