{"version":3,"file":"decoInjection-O8WHMQBx.js","sources":["../src/components/telegramMini/decoInjection.ts"],"sourcesContent":["import {ContractHandler} from './contractHandler';\n\nclass DecoInjection {\n  private boostedBackground = `\n    <div class=\"gradient-bg\">\n      <svg xmlns=\"http://www.w3.org/2000/svg\">\n        <defs>\n          <filter id=\"goo\">\n            <feGaussianBlur in=\"SourceGraphic\" stdDeviation=\"10\" result=\"blur\" />\n            <feColorMatrix in=\"blur\" mode=\"matrix\" values=\"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -8\" result=\"goo\" />\n            <feBlend in=\"SourceGraphic\" in2=\"goo\" />\n          </filter>\n        </defs>\n      </svg>\n      <div class=\"gradients-container\">\n        <div class=\"g1\"></div>\n        <div class=\"g2\"></div>\n        <div class=\"g3\"></div>\n        <div class=\"g4\"></div>\n        <div class=\"g5\"></div>\n        <!-- <div class=\"interactive\"></div> -->\n      </div>\n    </div>\n  `;\n\n  public init() {\n    this.setupURLChangeListener();\n    this.injectDeco();\n  }\n\n  private setupURLChangeListener() {\n    // Listen to the popstate event (back/forward navigation)\n    window.addEventListener('popstate', () => {\n      this.onURLChanged();\n    });\n\n    // Overwrite pushState and replaceState to listen to changes\n    const pushState = history.pushState;\n    history.pushState = (...args) => {\n      pushState.apply(history, args);\n      this.onURLChanged();\n    };\n\n    const replaceState = history.replaceState;\n    history.replaceState = (...args) => {\n      replaceState.apply(history, args);\n      this.onURLChanged();\n    };\n\n    // Listen to hashchange event\n    window.addEventListener('hashchange', () => {\n      console.log('hashchange')\n      this.onURLChanged();\n    });\n  }\n\n  private onURLChanged() {\n    const chatBackground = document.getElementsByClassName('chat-background')[1];\n    if(chatBackground) {\n      const currentChatId = localStorage.getItem('peerId');\n      const isBoosting = ContractHandler.boostedChatList.includes(currentChatId);\n\n      if(isBoosting) {\n        chatBackground.classList.remove('bg-invisible');\n      } else {\n        chatBackground.classList.add('bg-invisible');\n      }\n      // const contract = new ContractHandler('EQBfMfM9a9j-ulMHZdtSkWFaAdyQU6Cjkyom9eGQAgCX8afW');\n      // const channelId = Number(localStorage.getItem('peerId'));\n      // const isBoosting = await contract.isChannelBoosting(channelId);\n    }\n  }\n\n  private async injectDeco() {\n    const chatBackground = document.getElementsByClassName('chat-background')[0];\n    if(chatBackground) {\n      const newDiv = document.createElement('div');\n      newDiv.className = 'chat-background';\n      newDiv.classList.add('bg-invisible');\n      newDiv.innerHTML = this.boostedBackground;\n\n      chatBackground.insertAdjacentElement('afterend', newDiv);\n    }\n  }\n}\n\nexport default new DecoInjection();\n"],"names":["DecoInjection","pushState","args","replaceState","chatBackground","currentChatId","ContractHandler","newDiv","decoInjection"],"mappings":"yFAEA,MAAMA,CAAc,CAApB,aAAA,CACE,KAAQ,kBAAoB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAA,CAsBrB,MAAO,CACZ,KAAK,uBAAuB,EAC5B,KAAK,WAAW,CAClB,CAEQ,wBAAyB,CAExB,OAAA,iBAAiB,WAAY,IAAM,CACxC,KAAK,aAAa,CAAA,CACnB,EAGD,MAAMC,EAAY,QAAQ,UAClB,QAAA,UAAY,IAAIC,IAAS,CACrBD,EAAA,MAAM,QAASC,CAAI,EAC7B,KAAK,aAAa,CAAA,EAGpB,MAAMC,EAAe,QAAQ,aACrB,QAAA,aAAe,IAAID,IAAS,CACrBC,EAAA,MAAM,QAASD,CAAI,EAChC,KAAK,aAAa,CAAA,EAIb,OAAA,iBAAiB,aAAc,IAAM,CAC1C,QAAQ,IAAI,YAAY,EACxB,KAAK,aAAa,CAAA,CACnB,CACH,CAEQ,cAAe,CACrB,MAAME,EAAiB,SAAS,uBAAuB,iBAAiB,EAAE,CAAC,EAC3E,GAAGA,EAAgB,CACX,MAAAC,EAAgB,aAAa,QAAQ,QAAQ,EAChCC,EAAgB,gBAAgB,SAASD,CAAa,EAGxDD,EAAA,UAAU,OAAO,cAAc,EAE/BA,EAAA,UAAU,IAAI,cAAc,CAK/C,CACF,CAEA,MAAc,YAAa,CACzB,MAAMA,EAAiB,SAAS,uBAAuB,iBAAiB,EAAE,CAAC,EAC3E,GAAGA,EAAgB,CACX,MAAAG,EAAS,SAAS,cAAc,KAAK,EAC3CA,EAAO,UAAY,kBACZA,EAAA,UAAU,IAAI,cAAc,EACnCA,EAAO,UAAY,KAAK,kBAETH,EAAA,sBAAsB,WAAYG,CAAM,CACzD,CACF,CACF,CAEA,MAAeC,EAAA,IAAIR"}